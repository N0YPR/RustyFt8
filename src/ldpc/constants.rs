//! LDPC constants and matrix data for FT8
//!
//! This module contains all constant data used by the LDPC encoder and decoder:
//! - Code parameters (N, K, M)
//! - Generator matrix for encoding
//! - Parity check matrix structure for decoding

/// Codeword length (174 bits total)
pub const N: usize = 174;

/// Message length (77 information bits + 14 CRC bits)
pub const K: usize = 91;

/// Number of parity bits (N - K = 83)
pub const M: usize = 83;

/// Number of checks each bit participates in
pub const NCW: usize = 3;

/// Maximum number of bits involved in a single check
pub const MAX_NRW: usize = 7;

/// Generator matrix for LDPC(174,91) encoding
///
/// This is an 83Ã—91 matrix stored in compressed hexadecimal format.
/// Each row is represented as 23 hex digits (91 bits + padding).
/// The matrix is derived from the WSJT-X implementation.
pub const GENERATOR_MATRIX_HEX: [&str; 83] = [
    "8329ce11bf31eaf509f27fc",
    "761c264e25c259335493132",
    "dc265902fb277c6410a1bdc",
    "1b3f417858cd2dd33ec7f62",
    "09fda4fee04195fd034783a",
    "077cccc11b8873ed5c3d48a",
    "29b62afe3ca036f4fe1a9da",
    "6054faf5f35d96d3b0c8c3e",
    "e20798e4310eed27884ae90",
    "775c9c08e80e26ddae56318",
    "b0b811028c2bf997213487c",
    "18a0c9231fc60adf5c5ea32",
    "76471e8302a0721e01b12b8",
    "ffbccb80ca8341fafb47b2e",
    "66a72a158f9325a2bf67170",
    "c4243689fe85b1c51363a18",
    "0dff739414d1a1b34b1c270",
    "15b48830636c8b99894972e",
    "29a89c0d3de81d665489b0e",
    "4f126f37fa51cbe61bd6b94",
    "99c47239d0d97d3c84e0940",
    "1919b75119765621bb4f1e8",
    "09db12d731faee0b86df6b8",
    "488fc33df43fbdeea4eafb4",
    "827423ee40b675f756eb5fe",
    "abe197c484cb74757144a9a",
    "2b500e4bc0ec5a6d2bdbdd0",
    "c474aa53d70218761669360",
    "8eba1a13db3390bd6718cec",
    "753844673a27782cc42012e",
    "06ff83a145c37035a5c1268",
    "3b37417858cc2dd33ec3f62",
    "9a4a5a28ee17ca9c324842c",
    "bc29f465309c977e89610a4",
    "2663ae6ddf8b5ce2bb29488",
    "46f231efe457034c1814418",
    "3fb2ce85abe9b0c72e06fbe",
    "de87481f282c153971a0a2e",
    "fcd7ccf23c69fa99bba1412",
    "f0261447e9490ca8e474cec",
    "4410115818196f95cdd7012",
    "088fc31df4bfbde2a4eafb4",
    "b8fef1b6307729fb0a078c0",
    "5afea7acccb77bbc9d99a90",
    "49a7016ac653f65ecdc9076",
    "1944d085be4e7da8d6cc7d0",
    "251f62adc4032f0ee714002",
    "56471f8702a0721e00b12b8",
    "2b8e4923f2dd51e2d537fa0",
    "6b550a40a66f4755de95c26",
    "a18ad28d4e27fe92a4f6c84",
    "10c2e586388cb82a3d80758",
    "ef34a41817ee02133db2eb0",
    "7e9c0c54325a9c15836e000",
    "3693e572d1fde4cdf079e86",
    "bfb2cec5abe1b0c72e07fbe",
    "7ee18230c583cccc57d4b08",
    "a066cb2fedafc9f52664126",
    "bb23725abc47cc5f4cc4cd2",
    "ded9dba3bee40c59b5609b4",
    "d9a7016ac653e6decdc9036",
    "9ad46aed5f707f280ab5fc4",
    "e5921c77822587316d7d3c2",
    "4f14da8242a8b86dca73352",
    "8b8b507ad467d4441df770e",
    "22831c9cf1169467ad04b68",
    "213b838fe2ae54c38ee7180",
    "5d926b6dd71f085181a4e12",
    "66ab79d4b29ee6e69509e56",
    "958148682d748a38dd68baa",
    "b8ce020cf069c32a723ab14",
    "f4331d6d461607e95752746",
    "6da23ba424b9596133cf9c8",
    "a636bcbc7b30c5fbeae67fe",
    "5cb0d86a07df654a9089a20",
    "f11f106848780fc9ecdd80a",
    "1fbb5364fb8d2c9d730d5ba",
    "fcb86bc70a50c9d02a5d034",
    "a534433029eac15f322e34c",
    "c989d9c7c3d3b8c55d75130",
    "7bb38b2f0186d46643ae962",
    "2644ebadeb44b9467d1f42c",
    "608cc857594bfbb55d69600",
];

/// For each of N=174 bits, which 3 parity checks involve it
/// Mn[bit_index] = [check1, check2, check3]
/// (converted from Fortran 1-based to Rust 0-based indexing)
pub const MN: [[usize; NCW]; N] = [
    [15, 44, 72], [24, 50, 61], [32, 57, 77], [0, 43, 44], [1, 6, 60],
    [2, 5, 53], [3, 34, 47], [4, 12, 20], [7, 55, 78], [8, 63, 68],
    [9, 18, 65], [10, 35, 59], [11, 36, 57], [13, 31, 42], [14, 62, 79],
    [16, 27, 76], [17, 73, 82], [21, 52, 80], [22, 29, 33], [23, 30, 39],
    [25, 40, 75], [26, 56, 69], [28, 48, 64], [2, 37, 77], [4, 38, 81],
    [45, 49, 72], [50, 51, 73], [54, 70, 71], [43, 66, 71], [42, 67, 77],
    [0, 31, 58], [1, 5, 70], [3, 15, 53], [6, 64, 66], [7, 29, 41],
    [8, 21, 30], [9, 17, 75], [10, 22, 81], [11, 27, 60], [12, 51, 78],
    [13, 49, 50], [14, 80, 82], [16, 28, 59], [18, 32, 63], [19, 25, 72],
    [20, 33, 39], [23, 26, 76], [24, 54, 57], [34, 52, 65], [35, 47, 67],
    [36, 45, 74], [37, 44, 46], [38, 56, 68], [40, 55, 61], [19, 48, 52],
    [45, 51, 62], [44, 69, 74], [26, 34, 79], [0, 14, 29], [1, 67, 79],
    [2, 35, 50], [3, 27, 50], [4, 30, 55], [5, 19, 36], [6, 39, 81],
    [7, 59, 68], [8, 9, 48], [10, 43, 56], [11, 38, 58], [12, 23, 54],
    [13, 20, 64], [15, 70, 77], [16, 29, 75], [17, 24, 79], [18, 60, 82],
    [21, 37, 76], [22, 40, 49], [6, 25, 57], [28, 31, 80], [32, 39, 72],
    [17, 33, 47], [12, 41, 63], [4, 25, 42], [46, 68, 71], [53, 54, 69],
    [44, 61, 67], [9, 62, 66], [13, 65, 71], [21, 59, 73], [34, 38, 78],
    [0, 45, 63], [0, 23, 65], [1, 4, 69], [2, 30, 64], [3, 48, 57],
    [0, 3, 4], [5, 59, 66], [6, 31, 74], [7, 47, 81], [8, 34, 40],
    [9, 38, 61], [10, 13, 60], [11, 70, 73], [12, 22, 77], [10, 34, 54],
    [14, 15, 78], [6, 8, 15], [16, 53, 62], [17, 49, 56], [18, 29, 46],
    [19, 63, 79], [20, 27, 68], [21, 24, 42], [12, 21, 36], [1, 46, 50],
    [22, 53, 73], [25, 33, 71], [26, 35, 36], [20, 35, 62], [28, 39, 43],
    [18, 25, 56], [2, 45, 81], [13, 14, 57], [32, 51, 52], [29, 42, 51],
    [5, 8, 51], [26, 32, 64], [24, 68, 72], [37, 54, 82], [19, 38, 76],
    [17, 28, 55], [31, 47, 70], [41, 50, 58], [27, 43, 78], [33, 59, 61],
    [30, 44, 60], [45, 67, 76], [5, 23, 75], [7, 9, 77], [39, 40, 69],
    [16, 49, 52], [41, 65, 67], [3, 21, 71], [35, 63, 80], [12, 28, 46],
    [1, 7, 80], [55, 66, 72], [4, 37, 49], [11, 37, 63], [58, 71, 79],
    [2, 25, 78], [44, 75, 80], [0, 64, 73], [6, 17, 76], [10, 55, 58],
    [13, 38, 53], [15, 36, 65], [9, 27, 54], [14, 59, 69], [16, 24, 81],
    [19, 29, 30], [11, 66, 67], [22, 74, 79], [26, 31, 61], [23, 68, 74],
    [18, 20, 70], [33, 52, 60], [34, 45, 46], [32, 58, 75], [39, 42, 82],
    [40, 41, 62], [48, 74, 82], [19, 43, 47], [41, 48, 56],
];

/// For each of M=83 parity checks, which bits are involved (up to 7 bits)
/// Nm[check_index] = [bit1, bit2, bit3, bit4, bit5, bit6, bit7]
/// A value of 0 means unused (for checks with fewer than 7 bits)
/// (converted from Fortran 1-based to Rust 0-based indexing, 0 for unused)
pub const NM: [[usize; MAX_NRW]; M] = [
    [3, 30, 58, 90, 91, 95, 152],
    [4, 31, 59, 92, 114, 145, 0],
    [5, 23, 60, 93, 121, 150, 0],
    [6, 32, 61, 94, 95, 142, 0],
    [7, 24, 62, 82, 92, 95, 147],
    [5, 31, 63, 96, 125, 137, 0],
    [4, 33, 64, 77, 97, 106, 153],
    [8, 34, 65, 98, 138, 145, 0],
    [9, 35, 66, 99, 106, 125, 0],
    [10, 36, 66, 86, 100, 138, 157],
    [11, 37, 67, 101, 104, 154, 0],
    [12, 38, 68, 102, 148, 161, 0],
    [7, 39, 69, 81, 103, 113, 144],
    [13, 40, 70, 87, 101, 122, 155],
    [14, 41, 58, 105, 122, 158, 0],
    [0, 32, 71, 105, 106, 156, 0],
    [15, 42, 72, 107, 140, 159, 0],
    [16, 36, 73, 80, 108, 130, 153],
    [10, 43, 74, 109, 120, 165, 0],
    [44, 54, 63, 110, 129, 160, 172],
    [7, 45, 70, 111, 118, 165, 0],
    [17, 35, 75, 88, 112, 113, 142],
    [18, 37, 76, 103, 115, 162, 0],
    [19, 46, 69, 91, 137, 164, 0],
    [1, 47, 73, 112, 127, 159, 0],
    [20, 44, 77, 82, 116, 120, 150],
    [21, 46, 57, 117, 126, 163, 0],
    [15, 38, 61, 111, 133, 157, 0],
    [22, 42, 78, 119, 130, 144, 0],
    [18, 34, 58, 72, 109, 124, 160],
    [19, 35, 62, 93, 135, 160, 0],
    [13, 30, 78, 97, 131, 163, 0],
    [2, 43, 79, 123, 126, 168, 0],
    [18, 45, 80, 116, 134, 166, 0],
    [6, 48, 57, 89, 99, 104, 167],
    [11, 49, 60, 117, 118, 143, 0],
    [12, 50, 63, 113, 117, 156, 0],
    [23, 51, 75, 128, 147, 148, 0],
    [24, 52, 68, 89, 100, 129, 155],
    [19, 45, 64, 79, 119, 139, 169],
    [20, 53, 76, 99, 139, 170, 0],
    [34, 81, 132, 141, 170, 173, 0],
    [13, 29, 82, 112, 124, 169, 0],
    [3, 28, 67, 119, 133, 172, 0],
    [0, 3, 51, 56, 85, 135, 151],
    [25, 50, 55, 90, 121, 136, 167],
    [51, 83, 109, 114, 144, 167, 0],
    [6, 49, 80, 98, 131, 172, 0],
    [22, 54, 66, 94, 171, 173, 0],
    [25, 40, 76, 108, 140, 147, 0],
    [1, 26, 40, 60, 61, 114, 132],
    [26, 39, 55, 123, 124, 125, 0],
    [17, 48, 54, 123, 140, 166, 0],
    [5, 32, 84, 107, 115, 155, 0],
    [27, 47, 69, 84, 104, 128, 157],
    [8, 53, 62, 130, 146, 154, 0],
    [21, 52, 67, 108, 120, 173, 0],
    [2, 12, 47, 77, 94, 122, 0],
    [30, 68, 132, 149, 154, 168, 0],
    [11, 42, 65, 88, 96, 134, 158],
    [4, 38, 74, 101, 135, 166, 0],
    [1, 53, 85, 100, 134, 163, 0],
    [14, 55, 86, 107, 118, 170, 0],
    [9, 43, 81, 90, 110, 143, 148],
    [22, 33, 70, 93, 126, 152, 0],
    [10, 48, 87, 91, 141, 156, 0],
    [28, 33, 86, 96, 146, 161, 0],
    [29, 49, 59, 85, 136, 141, 161],
    [9, 52, 65, 83, 111, 127, 164],
    [21, 56, 84, 92, 139, 158, 0],
    [27, 31, 71, 102, 131, 165, 0],
    [27, 28, 83, 87, 116, 142, 149],
    [0, 25, 44, 79, 127, 146, 0],
    [16, 26, 88, 102, 115, 152, 0],
    [50, 56, 97, 162, 164, 171, 0],
    [20, 36, 72, 137, 151, 168, 0],
    [15, 46, 75, 129, 136, 153, 0],
    [2, 23, 29, 71, 103, 138, 0],
    [8, 39, 89, 105, 133, 150, 0],
    [14, 57, 59, 73, 110, 149, 162],
    [17, 41, 78, 143, 145, 151, 0],
    [24, 37, 64, 98, 121, 159, 0],
    [16, 41, 74, 128, 169, 171, 0],
];

/// Number of bits involved in each parity check (row weight)
/// nrw[check_index] = number of bits in that check (1-7)
pub const NRW: [usize; M] = [
    7, 6, 6, 6, 7, 6, 7, 6, 6, 7, 6, 6, 7, 7, 6, 6,
    6, 7, 6, 7, 6, 7, 6, 6, 6, 7, 6, 6, 6, 7, 6, 6,
    6, 6, 7, 6, 6, 6, 7, 7, 6, 6, 6, 6, 7, 7, 6, 6,
    6, 6, 7, 6, 6, 6, 7, 6, 6, 6, 6, 7, 6, 6, 6, 7,
    6, 6, 6, 7, 7, 6, 6, 7, 6, 6, 6, 6, 6, 6, 6, 7,
    6, 6, 6,
];
